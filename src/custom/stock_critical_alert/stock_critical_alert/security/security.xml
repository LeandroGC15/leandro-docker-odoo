<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- Categoría de Alertas de Stock -->
        <record id="module_category_stock_critical_alert" model="ir.module.category">
            <field name="name">Alertas de Stock Crítico</field>
            <field name="description">Permisos para gestionar alertas de stock crítico</field>
            <field name="sequence">30</field>
        </record>

        <!-- Grupo para usuarios que pueden ver alertas -->
        <record id="group_stock_alert_user" model="res.groups">
            <field name="name">Usuario / Alertas de Stock</field>
            <field name="category_id" ref="module_category_stock_critical_alert"/>
            <field name="implied_ids" eval="[(4, ref('stock.group_stock_user'))]"/>
            <field name="comment">Puede ver alertas de stock crítico</field>
        </record>

        <!-- Grupo para managers que pueden gestionar alertas -->
        <record id="group_stock_alert_manager" model="res.groups">
            <field name="name">Manager / Alertas de Stock</field>
            <field name="category_id" ref="module_category_stock_critical_alert"/>
            <field name="implied_ids" eval="[(4, ref('group_stock_alert_user'))]"/>
            <field name="comment">Puede crear, editar, resolver y eliminar alertas de stock</field>
        </record>
    </data>
    
    <data noupdate="1">
        <!-- Regla: Usuarios de almacén pueden ver alertas abiertas -->
        <record id="stock_alert_rule_stock_user" model="ir.rule">
            <field name="name">Alertas Stock: Usuarios pueden leer</field>
            <field name="model_id" ref="model_stock_critical_alert"/>
            <field name="domain_force">[('active', '=', True)]</field>
            <field name="groups" eval="[(4, ref('stock.group_stock_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <!-- Regla: Managers de almacén acceso completo -->
        <record id="stock_alert_rule_stock_manager" model="ir.rule">
            <field name="name">Alertas Stock: Managers acceso completo</field>
            <field name="model_id" ref="model_stock_critical_alert"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('stock.group_stock_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Regla: Grupo alert_user puede ver -->
        <record id="stock_alert_rule_alert_user" model="ir.rule">
            <field name="name">Alertas Stock: Grupo usuario puede leer</field>
            <field name="model_id" ref="model_stock_critical_alert"/>
            <field name="domain_force">[('active', '=', True)]</field>
            <field name="groups" eval="[(4, ref('group_stock_alert_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Regla: Grupo alert_manager acceso completo -->
        <record id="stock_alert_rule_alert_manager" model="ir.rule">
            <field name="name">Alertas Stock: Grupo manager acceso completo</field>
            <field name="model_id" ref="model_stock_critical_alert"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_stock_alert_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
    </data>
</odoo>

